Starting sampled data table generation...
Data folder: data
Unlabeled sample size: 10000
Random seed: 42
Output file: data_table_sampled_10k.csv
Save images: True
Clear intermediate: True
Checkpoint every: 500
Cleared previous CSV at data/data_table_sampled_10k.csv
Loaded 9 label names
Counting total plaques...
Total plaques available: 4746466
Unlabeled sample size: 10000
Loop 1: Adding labeled samples from npz file...
Added 89 labeled samples
Loop 2: Sampling unlabeled data...
Available unlabeled pairs: 4746377
Final collection: 0 plaques (labeled: 89, unlabeled: -89)
Total dataset size on disk: 10589 (existing + new)
Images saved to:
  Labeled: data/labeled_images
  Unlabeled: data/sampled_unlabeled_images

Sampled data table saved to: data/data_table_sampled_10k.csv
Final dataset shape on disk: (10589, 5)
Sample of the data:
                              Image  Index  Roundness        Area    Label
0  Image_2014-010_Occipital_AB.hdf5  10985   0.583290  871.407132  Diffuse
1        Image_2016-008_F2_BA4.hdf5   2444   0.612893  749.408632  Diffuse
2        Image_2019-025_LPI_AB.hdf5  10349   0.333608  290.018588  Diffuse
3         2018-014_F2_AB_Image.hdf5   9700   0.615867  201.278756  Diffuse
4        Image_2017-027_F2_BA4.hdf5   9487   0.355561  505.486708  Diffuse

Statistics:
Total plaques sampled: 10589
Unique images: 448
Plaques with labels: 589
Label distribution:
Label
Cored      107
Diffuse     81
Coarse      79
CAA         74
Subpial     73
Compact     63
UndefAB     43
NonAB       38
OtherAB     31
Name: count, dtype: int64
