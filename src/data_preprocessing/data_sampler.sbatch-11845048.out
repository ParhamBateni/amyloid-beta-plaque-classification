Starting sampled data table generation...
Data folder: data
Unlabeled sample size: 10000
Random seed: 42
Output file: data_table_sampled_10k.csv
Downsample size: (224, 224)
Save images: True
Loaded 9 label names
Counting total plaques...
Total plaques available: 4746466
Unlabeled sample size: 10000
Loop 1: Adding labeled samples from npz file...
Added 589 labeled samples
Loop 2: Sampling unlabeled data...
Available unlabeled pairs: 4745877
Final collection: 10589 plaques (labeled: 589, unlabeled: 10000)
Total dataset size: 10589 (all labeled + 10000 unlabeled)
Images saved to:
  Labeled: data/labeled_images
  Unlabeled: data/sampled_unlabeled_images

Sampled data table saved to: data/data_table_sampled_10k.csv
Final dataset shape: (10589, 5)
Sample of the data:
                              Image  Index  Roundness        Area  Label
0  Image_2014-010_Occipital_AB.hdf5  10985   0.583290  871.407132    0.0
1        Image_2016-008_F2_BA4.hdf5   2444   0.612893  749.408632    0.0
2        Image_2019-025_LPI_AB.hdf5  10349   0.333608  290.018588    0.0
3         2018-014_F2_AB_Image.hdf5   9700   0.615867  201.278756    0.0
4        Image_2017-027_F2_BA4.hdf5   9487   0.355561  505.486708    0.0

Statistics:
Total plaques sampled: 10589
Unique images: 446
Plaques with labels: 589
Label distribution:
Label
1.0    107
0.0     81
3.0     79
4.0     74
5.0     73
2.0     63
7.0     43
8.0     38
6.0     31
Name: count, dtype: int64
